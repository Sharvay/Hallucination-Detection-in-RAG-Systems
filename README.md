THE PROJECT IS CREATED AND READY BUT NO TIME TO CLEAN THE MESSY CODE AND ADD TO GITHUB WILL DO IT ASAP !!

# Hallucination-Detection-in-RAG-Systems

This project detects hallucinated spans in answers generated by language models using a token-level classifier based on ModernBERT. It supports QA-style prompts and integrates a retrieval and generation pipeline using BM25/FAISS for retrieval and T5 for generation. A Streamlit UI is included for interactive hallucination detection.

---

## Folder Structure

```bash
.
├── app/
│   ├── app.py                  # Streamlit UI
│   └── model_code.py           # Hallucination detection logic (non-class structure)
│
├── Data/
│   ├── response.json           # Model-generated responses
│   ├── source_info.jsonl       # Source passages (jsonl)
│
├── model/M05/                  # Saved ModernBERT model
│   └── config.json, model.safetensors, tokenizer files...
│
├── notebooks/
│   ├── hallucination_detector_training.ipynb  # Training notebook
│   ├── inference_demo.ipynb                   # Inference examples
│   └── Retriver_Generator.ipynb               # End-to-end retrieval + generation
│
├── scripts/
│   ├── data_utils.py           # Load & format dataset
│   ├── eval_utils.py           # Metrics for hallucination span detection
│   ├── hallucination_dataset.py # PyTorch Dataset with token labels
│   ├── main_train.py           # Training loop and data loader setup
│   ├── predict.py              # Predict hallucinated spans from prompt/answer
│   ├── retriever.py            # BM25 retriever using sklearn + TfidfVectorizer
│   ├── generator.py            # T5 answer generation from context
│
├── README.md
├── requirements.txt
```

## How It Works

1. **Retrieval**: Given a question, retrieve relevant passages using BM25.
2. **Generation**: Use T5 to answer the question using the retrieved passages.
3. **Detection**: Run hallucination detector to find unsupported answer spans.
4. **Highlight**: See hallucinated parts in red using the Streamlit app.

---

## Model

The token classification model is based on `answerdotai/ModernBERT-base` and fine-tuned on the [RAGTruth dataset](https://huggingface.co/datasets/wandb/RAGTruth-processed). Labels:
- `0`: Supported token
- `1`: Hallucinated token

---

